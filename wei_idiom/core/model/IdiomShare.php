<?php
 class IdiomShare { private static $table = "\x77\x65\151\x5f\151\x64\x69\157\x6d\x5f\163\x68\141\x72\x65"; private static $allFields = array("\x69\144", "\165\156\x69\141\x63\151\144", "\164\151\164\x6c\x65", "\163\x63\x65\156\145", "\x69\x6d\x61\147\x65", "\x69\x6e\163\145\162\164\137\164\x69\x6d\145", "\163\164\x61\x74\x75\x73"); const SHARE_SCENE_HOME = "\x68\x6f\155\x65"; const SHARE_SCENE_INVITE = "\151\156\x76\x69\x74\145"; const SHARE_SCENE_GUESS = "\x67\x75\145\x73\x73"; public static $mapScene2Desc = array(self::SHARE_SCENE_HOME => "\351\xa6\226\351\241\265\xe5\210\x86\344\xba\253", self::SHARE_SCENE_INVITE => "\xe9\202\200\xe8\xaf\267\351\241\265\xe5\x88\206\xe4\xba\xab", self::SHARE_SCENE_GUESS => "\xe7\214\x9c\351\242\x98\xe9\xa1\xb5\xe5\210\206\344\272\253"); const STATUS_OK = 1; const STATUS_FORBID = -1; public static function getShare($uniacid) { $res = pdo_getall(self::$table, ["\x75\156\151\x61\x63\x69\144" => $uniacid, "\x73\164\141\x74\165\x73" => self::STATUS_OK], self::$allFields, '', "\151\144\40\x44\x45\123\103", "\x30\x2c\x31\x30"); return false == $res ? [] : $res; } public static function getShareList($uniacid, $pageIndex, $pageSize) { goto vYK0O; B6G7X: $start = ($pageIndex - 1) * $pageSize; goto tGxMT; vYK0O: $where["\165\x6e\x69\141\x63\x69\x64"] = $uniacid; goto B6G7X; tGxMT: $list = pdo_getall(self::$table, $where, self::$allFields, '', "\x69\x64\x20\104\x45\123\x43", "{$start}\x2c\40{$pageSize}"); goto wTriM; wTriM: return false == $list ? [] : $list; goto r4v3T; r4v3T: } public static function getShareCount($uniacid) { $where["\x75\x6e\x69\141\143\151\144"] = $uniacid; return pdo_count(self::$table, $where, 30); } public static function create($uniacid, $data) { goto zyhjf; op35n: $data["\x75\156\151\141\x63\151\x64"] = $uniacid; goto GSPdo; zyhjf: $data["\x69\x6e\x73\145\x72\x74\137\x74\x69\155\x65"] = date("\x59\55\x6d\55\x64\x20\110\72\x69\x3a\x73"); goto op35n; GSPdo: return pdo_insert(self::$table, $data); goto HAdWJ; HAdWJ: } public static function update($openid, $uniacid, $data) { goto HmhVY; SIpbK: return $res; goto KF_d1; HmhVY: $data["\x75\x70\144\141\x74\145\x5f\164\151\x6d\145"] = date("\x59\x2d\x6d\55\144\x20\110\72\151\x3a\163"); goto miTRF; miTRF: $res = pdo_update(self::$table, $data, ["\157\x70\x65\156\151\144" => $openid, "\165\x6e\x69\x61\143\151\144" => $uniacid]); goto SIpbK; KF_d1: } public static function getShareConf($uniacid) { goto CafSi; ZXLcD: if (!empty($list)) { goto KIyI0; } goto Kwn7y; x78px: goto zjAqP; goto MfAHd; lVuJc: UaCS2: goto x78px; Kwn7y: foreach (self::$mapScene2Desc as $scene => $v) { $ret[$scene] = []; LN4z8: } goto lVuJc; nqHXM: YPY2s: goto zQuQL; YwJZN: $ret = []; goto ZXLcD; ZnOSp: return $ret; goto s1Btq; zQuQL: zjAqP: goto ZnOSp; CafSi: $list = self::getShare($uniacid); goto YwJZN; FbwfI: foreach ($list as $key => $val) { goto IaCIC; Ey0S8: SCllR: goto uevgt; IaCIC: foreach (self::$mapScene2Desc as $scene => $v) { goto Tfy4F; B5LqE: WObh1: goto YSCmY; Tfy4F: !isset($ret[$scene]) && ($ret[$scene] = []); goto XQJ2i; XQJ2i: $val["\x73\x63\x65\x6e\145"] == $scene && ($ret[$scene][] = $val); goto B5LqE; YSCmY: } goto DYxLa; DYxLa: zvWEW: goto Ey0S8; uevgt: } goto nqHXM; MfAHd: KIyI0: goto FbwfI; s1Btq: } }